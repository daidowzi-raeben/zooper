import{W as V,r as n,Q as U,c as i,g as l,H as b,I as c,n as E,t as v,z as y,e as _,X as D,F as T,D as q,Y as B,Z as F,b as d}from"./entry.DzORWLaw.js";import{b as x}from"./api.xjxtr2Ie.js";const L={class:"max-w-md mx-auto mt-10 p-6 bg-white rounded shadow"},z={class:"flex items-center space-x-2"},I={class:"relative"},K=["disabled"],N={key:1,class:"absolute z-10 w-full bg-white border mt-1 max-h-40 overflow-auto shadow rounded"},P=["onClick"],A={class:"text-sm text-gray-500"},M=["disabled"],W={__name:"signUp",setup(R){const s=V({mb_name:"",mb_id:"",mb_email:"",mb_pw:"",mb_pw_check:"",mb_school:"",mb_school_idx:null}),u=n(""),a=n(!1),m=n(!1),r=n(""),f=n([]),p=n(!1),k=()=>{s.mb_school="",s.mb_school_idx=null,r.value="",f.value=[],m.value=!1},w=async()=>{if(r.value.length>1)try{const t=await x("teacher.php",{mode:"schoolList",school:r.value});f.value=t.data||[],p.value=!0}catch(t){console.error(t)}else p.value=!1},g=t=>{s.mb_school=t.school,s.mb_school_idx=t.idx,r.value=t.school,p.value=!1,m.value=!0},C=async()=>{await F();const t=`${s.mb_id}@korea.kr`;if(s.mb_email=t,s.mb_id.length>1)try{const e=await x("teacher.php",{mode:"checkEmail",email:t});console.log(e.result),(e==null?void 0:e.result)==="DUPLICATE"?(u.value="이미 사용 중인 이메일입니다.",a.value=!1):(u.value="사용 가능한 이메일입니다.",a.value=!0)}catch(e){console.error(e),u.value="오류가 발생했습니다.",a.value=!1}else u.value="아이디를 입력해주세요",a.value=!1},S=U(()=>s.mb_name&&s.mb_id&&s.mb_pw&&s.mb_pw_check&&s.mb_pw===s.mb_pw_check&&a.value&&s.mb_school_idx),h=async()=>{if(s.mb_pw!==s.mb_pw_check){alert("비밀번호가 일치하지 않습니다.");return}try{const t=await x("teacher.php",{mode:"insert",...s});t.result==="SUCCESS"?(alert("가입이 완료되었습니다."),location.href="/login"):t.result==="DUPLICATE"?alert("이미 등록된 이메일입니다."):alert("가입에 실패했습니다.")}catch(t){console.error(t),alert("오류가 발생했습니다.")}};return(t,e)=>(d(),i("div",L,[e[13]||(e[13]=l("h2",{class:"text-2xl font-bold mb-4"},"교사 회원가입",-1)),l("form",{onSubmit:B(h,["prevent"]),class:"space-y-4"},[l("div",null,[e[5]||(e[5]=l("label",{for:"mb_name",class:"block mb-1 font-medium"},"이름",-1)),b(l("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>s.mb_name=o),id:"mb_name",type:"text",class:"w-full border rounded px-3 py-2",required:""},null,512),[[c,s.mb_name]])]),l("div",null,[e[7]||(e[7]=l("label",{for:"mb_id",class:"block mb-1 font-medium"},"이메일",-1)),l("div",z,[b(l("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>s.mb_id=o),onBlur:C,id:"mb_id",type:"text",class:"flex-grow border rounded px-3 py-2",placeholder:"아이디 입력",required:""},null,544),[[c,s.mb_id]]),e[6]||(e[6]=l("span",{class:"text-gray-700"},"@korea.kr",-1))]),l("p",{class:E(["text-sm mt-1",a.value?"text-green-600":"text-red-600"])},v(u.value),3)]),l("div",null,[e[8]||(e[8]=l("label",{for:"mb_pw",class:"block mb-1 font-medium"},"비밀번호",-1)),b(l("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>s.mb_pw=o),id:"mb_pw",type:"password",class:"w-full border rounded px-3 py-2",required:""},null,512),[[c,s.mb_pw]])]),l("div",null,[e[9]||(e[9]=l("label",{for:"mb_pw_check",class:"block mb-1 font-medium"},"비밀번호 확인",-1)),b(l("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>s.mb_pw_check=o),id:"mb_pw_check",type:"password",class:"w-full border rounded px-3 py-2",required:""},null,512),[[c,s.mb_pw_check]])]),l("div",null,[e[11]||(e[11]=l("label",{for:"mb_school",class:"block mb-1 font-medium"},[y(" 학교명 "),l("span",{class:"text-sm text-gray-500"},"(키워드 입력 후 엔터로 검색할 수 있습니다.)")],-1)),l("div",I,[b(l("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>r.value=o),id:"mb_school",type:"search",placeholder:"학교명을 검색하세요",class:"w-full border rounded px-3 py-2 pr-10",disabled:m.value,onKeyup:D(w,["enter"])},null,40,K),[[c,r.value]]),m.value?_("",!0):(d(),i("button",{key:0,type:"button",class:"absolute inset-y-0 right-0 flex items-center px-3 text-gray-500",onClick:w},e[10]||(e[10]=[l("i",{class:"fas fa-search"},null,-1)]))),p.value?(d(),i("ul",N,[(d(!0),i(T,null,q(f.value,o=>(d(),i("li",{key:o.idx,onClick:$=>g(o),class:"px-3 py-2 hover:bg-gray-100 cursor-pointer"},[y(v(o.school)+" ",1),l("span",A,"("+v(o.addr)+")",1)],8,P))),128))])):_("",!0),m.value?(d(),i("div",{key:2,class:"mt-1 text-sm text-blue-600 underline cursor-pointer",onClick:k}," 다시 검색 ")):_("",!0)]),e[12]||(e[12]=l("div",{class:"mt-6 mb-4 text-sm text-gray-600 leading-relaxed"},[l("p",{class:"text-red-600 font-semibold mb-2"}," ※ 선생님이 아닌 학생이 장난으로 가입할 경우, 해당 선생님에게 즉시 보고됩니다. "),l("p",{class:"mb-2"},"회원가입은 선생님 인증 후에 사용이 가능합니다."),l("p",{class:"mb-1"},"- 이용약관: 본 서비스는 교육 목적으로만 제공되며, 무단 사용 시 제재를 받을 수 있습니다."),l("p",null,"- 개인정보처리방침: 수집된 정보는 수업 및 교육 운영 이외의 용도로 사용되지 않습니다.")],-1))]),l("button",{type:"button",onClick:h,disabled:!S.value,class:"w-full bg-blue-600 text-white font-bold py-2 px-4 rounded hover:bg-blue-700 disabled:opacity-50"}," 가입하기 ",8,M)],32)]))}};export{W as default};
