{"version":3,"file":"login-CcEUpybS.js","sources":["../../../../pages/login.vue"],"sourcesContent":["<template>\n  <div\n    class=\"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-blue-100 via-purple-100 to-white px-4\">\n    <div class=\"bg-white rounded-xl shadow-xl p-8 max-w-sm w-full text-center\">\n      <h1 class=\"text-2xl font-bold text-gray-800 mb-4\">QR 코드 로그인</h1>\n      <p class=\"text-sm text-gray-600 mb-6\">QR 코드를 스캔해주세요</p>\n\n      <button v-if=\"!isScanning && !isScanningTeacher\"\n        class=\"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-full transition\"\n        @click=\"startScan\">\n        QR코드로 로그인\n      </button>\n\n      <div class=\"mt-6 mb-6\">\n        <button v-if=\"!isScanning && !isScanningTeacher\" @click=\"startScanTeacher\"\n          class=\"text-blue-600 underline text-sm hover:text-blue-800\">\n          선생님이신가요?\n        </button>\n      </div>\n\n      <qrcode-stream v-if=\"isScanning\" @detect=\"onDetect\" @error=\"onError\" />\n      <button v-if=\"isScanning\"\n        class=\"w-full bg-gray-400 hover:bg-gray-500 text-white font-semibold py-2 px-4 rounded-md transition mt-2\"\n        @click=\"isScanning = false\">취소</button>\n      <div v-if=\"isScanningTeacher\" class=\"mt-6 space-y-4 text-left\">\n        <div>\n          <label for=\"userId\" class=\"block text-sm font-medium text-gray-700\">이메일</label>\n          <input v-model=\"mb_email\" type=\"text\" id=\"userId\" name=\"userId\"\n            class=\"mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500\" />\n        </div>\n        <div>\n          <label for=\"password\" class=\"block text-sm font-medium text-gray-700\">비밀번호</label>\n          <input v-model=\"mb_pw\" type=\"password\" id=\"password\" name=\"password\"\n            class=\"mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500\" />\n        </div>\n        <div>\n          <button class=\"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-md transition\"\n            @click=\"onClickLogin\">로그인</button>\n          <button\n            class=\"w-full bg-gray-400 hover:bg-gray-500 text-white font-semibold py-2 px-4 rounded-md transition mt-2\"\n            @click=\"isScanningTeacher = false\">취소</button>\n          <div class=\"text-center mt-4\">\n            <router-link to=\"/signUp\" class=\"text-sm text-blue-600 underline hover:text-blue-800\">가입하기</router-link>\n          </div>\n        </div>\n      </div>\n      <!-- <qrcode-stream\n        v-if=\"isScanningTeacher\"\n        @detect=\"onDetectTeacher\"\n        @error=\"onErrorTeacher\"\n      /> -->\n\n      <p v-if=\"error\" class=\"text-red-500 text-sm mt-4\">{{ error }}</p>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { QrcodeStream } from 'vue-qrcode-reader'\nimport { apiPost } from '@/common/api';\n\nconst isScanning = ref(false)\nconst isScanningTeacher = ref(false)\nconst error = ref('')\nconst errorTeacher = ref('')\nconst mb_email = ref('')\nconst mb_pw = ref('')\nconst router = useRouter()\n\nconst startScan = () => {\n  isScanning.value = true\n  error.value = ''\n}\nconst startScanTeacher = () => {\n  isScanningTeacher.value = true\n  errorTeacher.value = ''\n}\n\nconst onDetect = (detectedCodes) => {\n  const url = detectedCodes[0]?.rawValue\n  if (!url) return\n\n  isScanning.value = false\n  router.push('/sign/' + url)\n}\n\nconst onError = (err) => {\n  error.value = '카메라 접근 실패'\n  console.error(err)\n  isScanning.value = false\n}\n\n\nconst onDetectTeacher = (detectedCodes) => {\n  const url = detectedCodes[0]?.rawValue\n  if (!url) return\n\n  isScanning.value = false\n  router.push('/teacher/' + url)\n}\n\nconst onErrorTeacher = (err) => {\n  errorTeacher.value = '카메라 접근 실패'\n  console.error(err)\n  isScanningTeacher.value = false\n}\n\nconst onClickLogin = async () => {\n  if (!mb_email.value || !mb_pw.value) return alert('이메일과 비밀번호를 모두 입력해 주세요.')\n  try {\n    const res = await apiPost('teacher.php', {\n      mode: 'login',\n      mb_email: mb_email.value,\n      mb_pw: mb_pw.value,\n    });\n    console.log(res?.data)\n    if (res?.result == 'SUCCESS') {\n\n      sessionStorage.setItem('t_idnt_code', res?.data?.idnt_code)\n      sessionStorage.setItem('idnt_code', 'teacher')\n      sessionStorage.setItem('teacher', JSON.stringify(res?.data))\n      window.location.href = '/teacher'\n\n    } else {\n      if (res?.result == 'NOT_APPROVED') {\n        return alert('승인되지 않은 계정입니다. 관리자에게 문의하세요.')\n      }\n\n      return alert('로그인에 실패했습니다.')\n    }\n\n  } catch (err) {\n    console.error(err);\n  }\n\n}\n</script>\n\n<script>\nexport default {\n  components: {\n    QrcodeStream: () => import('vue-qrcode-reader').then(m => m.QrcodeStream)\n  }\n}\n</script>"],"names":["_ssrRenderAttrs","_mergeProps","_push","_parent"],"mappings":";;;;;;AA6IA,MAAe,cAAA;AAAA,EACb,YAAY;AAAA,IACV,cAAc,MAAM,OAAO,mBAAmB,EAAE,KAAK,CAAA,MAAK,EAAE,YAAY;AAAA,EAAA;AAE5E;;;;;AAlFM,UAAA,aAAa,IAAI,KAAK;AACtB,UAAA,oBAAoB,IAAI,KAAK;AAC7B,UAAA,QAAQ,IAAI,EAAE;AACC,QAAI,EAAE;AACrB,UAAA,WAAW,IAAI,EAAE;AACjB,UAAA,QAAQ,IAAI,EAAE;AACpB,UAAM,SAAS,UAAU;AAWnB,UAAA,WAAW,CAAC,kBAAkB;;AAC5B,YAAA,OAAM,mBAAc,CAAC,MAAf,mBAAkB;AAC9B,UAAI,CAAC;AAAK;AAEV,iBAAW,QAAQ;AACZ,aAAA,KAAK,WAAW,GAAG;AAAA,IAC5B;AAEM,UAAA,UAAU,CAAC,QAAQ;AACvB,YAAM,QAAQ;AACd,cAAQ,MAAM,GAAG;AACjB,iBAAW,QAAQ;AAAA,IACrB;;;AA1FI,YAAA,OAAAA,eAAAC,WAAA,EAAA,OAAM,yHAAqH,MAAA,CAAA,CAAA,qMAAA;AAK1G,UAAA,CAAA,WAAA,UAAe,kBAAiB,OAAA;;;;;;AAO9B,UAAA,CAAA,WAAA,UAAe,kBAAiB,OAAA;;;;;;UAM5B,WAAU,OAAA;;UAAG;AAAA,UAAmB;AAAA,QAAA;;;;UACvC,WAAU,OAAA;;;;;UAGb,kBAAiB,OAAA;wKAGR,SAAQ,KAAA,+RAKR,MAAK,KAAA;;UAUN,IAAG;AAAA,UAAU,OAAM;AAAA,QAAA;2BAAhC,CAAwG,GAAAC,QAAAC,UAAA,aAAA;;;;;gCAAlB,MAAI;AAAA;;;;;;;;;UAUvF,MAAK,OAAA;qEAAuC,MAAK,KAAA,CAAA,MAAA;AAAA,MAAA;;;;;;;;;;;;;"}