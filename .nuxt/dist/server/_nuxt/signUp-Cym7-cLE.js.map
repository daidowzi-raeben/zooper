{"version":3,"file":"signUp-Cym7-cLE.js","sources":["../../../../pages/signUp.vue"],"sourcesContent":["<script setup>\nimport { ref, reactive, computed } from 'vue';\nimport { apiPost } from '@/common/api';\nimport { nextTick } from 'vue';\n\nconst form = reactive({\n  mb_name: '',\n  mb_id: '',\n  mb_email: '',\n  mb_pw: '',\n  mb_pw_check: '',\n  mb_school: '',\n  mb_school_idx: null,\n});\n\nconst emailStatus = ref('');\nconst isValidEmail = ref(false);\nconst isSchoolSelected = ref(false);\nconst searchKeyword = ref('');\nconst searchResults = ref([]);\nconst showResults = ref(false);\n\nconst resetSchool = () => {\n  form.mb_school = '';\n  form.mb_school_idx = null;\n  searchKeyword.value = '';\n  searchResults.value = [];\n  isSchoolSelected.value = false;\n};\n\nconst searchSchool = async () => {\n  if (searchKeyword.value.length > 1) {\n    try {\n      const res = await apiPost('teacher.php', {\n        mode: 'schoolList',\n        school: searchKeyword.value,\n      });\n      searchResults.value = res.data || [];\n      showResults.value = true;\n    } catch (err) {\n      console.error(err);\n    }\n  } else {\n    showResults.value = false;\n  }\n};\n\nconst selectSchool = (school) => {\n  form.mb_school = school.school;\n  form.mb_school_idx = school.idx;\n  searchKeyword.value = school.school;\n  showResults.value = false;\n  isSchoolSelected.value = true;\n};\n\nconst checkEmail = async () => {\n  await nextTick(); // form.mb_id 최신값 반영 보장\n\n  const emailFull = `${form.mb_id}@korea.kr`;\n  form.mb_email = emailFull;\n\n  if (form.mb_id.length > 1) {\n    try {\n      const res = await apiPost('teacher.php', {\n        mode: 'checkEmail',\n        email: emailFull,\n      });\n      console.log(res.result)\n      if (res?.result === 'DUPLICATE') {\n        emailStatus.value = '이미 사용 중인 이메일입니다.';\n        isValidEmail.value = false;\n      } else {\n        emailStatus.value = '사용 가능한 이메일입니다.';\n        isValidEmail.value = true;\n      }\n    } catch (e) {\n      console.error(e);\n      emailStatus.value = '오류가 발생했습니다.';\n      isValidEmail.value = false;\n    }\n  } else {\n    emailStatus.value = '아이디를 입력해주세요';\n    isValidEmail.value = false;\n  }\n};\n\nconst isFormValid = computed(() => {\n  return (\n    form.mb_name &&\n    form.mb_id &&\n    form.mb_pw &&\n    form.mb_pw_check &&\n    form.mb_pw === form.mb_pw_check &&\n    isValidEmail.value &&\n    form.mb_school_idx\n  );\n});\n\nconst submit = async () => {\n  if (form.mb_pw !== form.mb_pw_check) {\n    alert('비밀번호가 일치하지 않습니다.');\n    return;\n  }\n\n  try {\n    const res = await apiPost('teacher.php', {\n      mode: 'insert',\n      ...form\n    });\n\n    if (res.result === 'SUCCESS') {\n      alert('가입이 완료되었습니다.');\n      location.href = '/login';\n    } else if (res.result === 'DUPLICATE') {\n      alert('이미 등록된 이메일입니다.');\n    } else {\n      alert('가입에 실패했습니다.');\n    }\n  } catch (e) {\n    console.error(e);\n    alert('오류가 발생했습니다.');\n  }\n};\n</script>\n\n<template>\n  <div class=\"max-w-md mx-auto mt-10 p-6 bg-white rounded shadow\">\n    <h2 class=\"text-2xl font-bold mb-4\">교사 회원가입</h2>\n    <form @submit.prevent=\"submit\" class=\"space-y-4\">\n      <div>\n        <label for=\"mb_name\" class=\"block mb-1 font-medium\">이름</label>\n        <input v-model=\"form.mb_name\" id=\"mb_name\" type=\"text\" class=\"w-full border rounded px-3 py-2\" required />\n      </div>\n      <div>\n        <label for=\"mb_id\" class=\"block mb-1 font-medium\">이메일</label>\n        <div class=\"flex items-center space-x-2\">\n          <input v-model=\"form.mb_id\" @blur=\"checkEmail\" id=\"mb_id\" type=\"text\"\n            class=\"flex-grow border rounded px-3 py-2\" placeholder=\"아이디 입력\" required />\n          <span class=\"text-gray-700\">@korea.kr</span>\n        </div>\n        <p class=\"text-sm mt-1\" :class=\"isValidEmail ? 'text-green-600' : 'text-red-600'\">\n          {{ emailStatus }}\n        </p>\n      </div>\n      <div>\n        <label for=\"mb_pw\" class=\"block mb-1 font-medium\">비밀번호</label>\n        <input v-model=\"form.mb_pw\" id=\"mb_pw\" type=\"password\" class=\"w-full border rounded px-3 py-2\" required />\n      </div>\n      <div>\n        <label for=\"mb_pw_check\" class=\"block mb-1 font-medium\">비밀번호 확인</label>\n        <input v-model=\"form.mb_pw_check\" id=\"mb_pw_check\" type=\"password\" class=\"w-full border rounded px-3 py-2\"\n          required />\n      </div>\n      <div>\n        <label for=\"mb_school\" class=\"block mb-1 font-medium\">\n          학교명 <span class=\"text-sm text-gray-500\">(키워드 입력 후 엔터로 검색할 수 있습니다.)</span>\n        </label>\n        <div class=\"relative\">\n          <input v-model=\"searchKeyword\" id=\"mb_school\" type=\"search\" placeholder=\"학교명을 검색하세요\"\n            class=\"w-full border rounded px-3 py-2 pr-10\" :disabled=\"isSchoolSelected\" @keyup.enter=\"searchSchool\" />\n          <button type=\"button\" class=\"absolute inset-y-0 right-0 flex items-center px-3 text-gray-500\"\n            @click=\"searchSchool\" v-if=\"!isSchoolSelected\">\n            <i class=\"fas fa-search\"></i>\n          </button>\n          <ul v-if=\"showResults\"\n            class=\"absolute z-10 w-full bg-white border mt-1 max-h-40 overflow-auto shadow rounded\">\n            <li v-for=\"school in searchResults\" :key=\"school.idx\" @click=\"selectSchool(school)\"\n              class=\"px-3 py-2 hover:bg-gray-100 cursor-pointer\">\n              {{ school.school }} <span class=\"text-sm text-gray-500\">({{ school.addr }})</span>\n            </li>\n          </ul>\n          <div v-if=\"isSchoolSelected\" class=\"mt-1 text-sm text-blue-600 underline cursor-pointer\" @click=\"resetSchool\">\n            다시 검색\n          </div>\n        </div>\n        <div class=\"mt-6 mb-4 text-sm text-gray-600 leading-relaxed\">\n          <p class=\"text-red-600 font-semibold mb-2\">\n            ※ 선생님이 아닌 학생이 장난으로 가입할 경우, 해당 선생님에게 즉시 보고됩니다.\n          </p>\n          <p class=\"mb-2\">회원가입은 선생님 인증 후에 사용이 가능합니다.</p>\n          <p class=\"mb-1\">- 이용약관: 본 서비스는 교육 목적으로만 제공되며, 무단 사용 시 제재를 받을 수 있습니다.</p>\n          <p>- 개인정보처리방침: 수집된 정보는 수업 및 교육 운영 이외의 용도로 사용되지 않습니다.</p>\n        </div>\n      </div>\n      <button type=\"button\" @click=\"submit\" :disabled=\"!isFormValid\"\n        class=\"w-full bg-blue-600 text-white font-bold py-2 px-4 rounded hover:bg-blue-700 disabled:opacity-50\">\n        가입하기\n      </button>\n    </form>\n  </div>\n</template>"],"names":["_ssrRenderAttrs","_mergeProps","_ssrRenderAttr","_ssrRenderList","_ssrInterpolate"],"mappings":";;;;;;;;AAKA,UAAM,OAAO,SAAS;AAAA,MACpB,SAAS;AAAA,MACT,OAAO;AAAA,MACP,UAAU;AAAA,MACV,OAAO;AAAA,MACP,aAAa;AAAA,MACb,WAAW;AAAA,MACX,eAAe;AAAA,IAAA,CAChB;AAEK,UAAA,cAAc,IAAI,EAAE;AACpB,UAAA,eAAe,IAAI,KAAK;AACxB,UAAA,mBAAmB,IAAI,KAAK;AAC5B,UAAA,gBAAgB,IAAI,EAAE;AACtB,UAAA,gBAAgB,IAAI,EAAE;AACtB,UAAA,cAAc,IAAI,KAAK;AAkEvB,UAAA,cAAc,SAAS,MAAM;AACjC,aACE,KAAK,WACL,KAAK,SACL,KAAK,SACL,KAAK,eACL,KAAK,UAAU,KAAK,eACpB,aAAa,SACb,KAAK;AAAA,IAAA,CAER;;mBA8BMA,eAAAC,WAAA,EAAA,OAAM,qDAAoD,GAAA,MAAA,CAAA,sJAKzCC,cAAA,SAAA,KAAK,OAAO,sMAKVA,cAAA,SAAA,KAAK,KAAK,iLAII,aAAY,QAAA,mBAAA,gBAAA,cAAA,CAAA,qBACvC,YAAW,KAAA,uFAKAA,cAAA,SAAA,KAAK,KAAK,yKAIVA,cAAA,SAAA,KAAK,WAAW,6RAQd,cAAa,KAAA,8HAC8B,iBAAgB,KAAA,IAAA,cAAA;WAE5C,iBAAgB,OAAA;;;;;UAGrC,YAAW,OAAA;;AAEEC,sBAAA,cAAA,QAAV,WAAM;0EAEZC,eAAA,OAAO,MAAM,0CAA4CA,eAAA,OAAO,IAAI;;;;;;UAGhE,iBAAgB,OAAA;;;;;sZAamB,YAAW,KAAA,IAAA,cAAA,EAAA,uIAAA;AAAA;;;;;;;;;"}